#!/bin/bash
pid=$$
conan remote login -p docker xtuml docker &&\
conan create .  --format=json --build=missing "$@" > /tmp/${pid}_create.json &&\
conan list --graph=/tmp/${pid}_create.json --graph-binaries=build --format=json > /tmp/${pid}_pkglist.json &&\
conan upload --list=/tmp/${pid}_pkglist.json -r=xtuml -c &&\
rm /tmp/${pid}_*